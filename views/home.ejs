<%- include("partials/header")%>
  <%- include("partials/navbar")%>

    <div class="container text-center text-michgold">
      <div class="header-image text-white my-3 border rounded-2"  style="background-image: url(/static/images/apiary.jpeg)">
  
        <H1 class="text-center text-white mt-2 outlined-text display-1 fw-bold sticky-top apiary" id="iconPrompt">Apiary</H1>
        <h5 class="card-title mt-3 fs-2 outlined-text" id="datetime"></h5>
          <div class="d-flex justify-content-between text-white outlined-text fs-3 fw-bold mt-4 me-2">
              <p class="card-text ms-2" id="city"></p>
              <p class="card-text" id="temp"><span id="clouds">üå§Ô∏è</span></p>
          </div>
    </div>
      <div class="row row-cols-1 row-cols-lg-3 g-2">
        <!-- insert cards here -->
        <% data.forEach((hive) => {%>
        <div class="col">
          <div class="container px-2" style="max-width: 500px">
            <div class="card text-michgold border-michgold rounded-5 border-3">
              <div class="card-header fs-4 fw-bold text-center pb-0">Hive # <%= hive.hiveNumber %></div>
              <div class="card-header fs-6 fw-bold text-center pb-0"><%= hive.breed %></div>
              <div
                class="card-body pb-2 pt-1 mt-0 m-1 mb-2 d-flex fw-semibold fs-5 
                justify-content-between align-items-baseline"
              >
                <div>Added: </div>
                <div ><%= hive.hiveDate %></div>
               
                <div><%= hive.hiveStrength %>%</div>
              </div>
              <!-- Fixed here and on Index.js -->
              <div class="d-flex justify-content-between mx-3 mb-2">
                <form action="/hive/delete/<%= hive.id %>?_method=DELETE" method="post">
                  <input type="hidden" name="_method"
                  value="DELETE">
                  <input type="submit" value="DELETE" name="" id="" class="btn rounded-5 btn-danger">
                </form>
                <a
                  href="/hive/edit/<%= hive.id %>"
                  class="btn btn-primary rounded-5 px-4"
                  style="max-width: 30vw"
                  >EDIT</a
                >

              </div>
            </div>
          </div>
        </div>
        <% }) %>

        <!-- cards end -->
      </div> 
      
      
      <div class="fixedBtn" >
        <a
        href="hive-form"
        type="button"
        class="btn btn-lg px-4  btn-michgold btn-gold rounded-pill "
        style="
        position: fixed;
        left: 71%;
        top: 80%;
      ">
        ADD
        </a>
       
      </div>
    </div>
  
      <%- include("partials/footer")%>
      <script>
          

          // const lat = 42.8478072;
          // const long = -83.4481557;
          // const apiKey = '<%= process.env.WEATHER_KEY %>';
          // const apiUrl = 'https://api.openweathermap.org/data/2.5/weather?units=imperial&q=michigan';

          // async function checkWeather(){
          //   const response = await fetch(apiUrl + `&appid=${apiKey}` );
          //   let data = await response.json();

          //   console.log(data);
          //   document.querySelector('#city').innerHTML = data.name;
          //   document.querySelector('#temp').innerHTML = Math.round(data.main.temp) + '‚Ñâ';
          //   document.querySelector('#clouds').innerHTML = data.clouds;

          // }

          // checkWeather();

          const apiKey = '<%= process.env.WEATHER_KEY %>';
          const apiUrl = 'https://api.openweathermap.org/data/2.5/weather?units=imperial';

          async function getCurrentLocation() {
            return new Promise((resolve, reject) => {
              navigator.geolocation.getCurrentPosition(resolve, reject);
            });
          }

          async function checkWeather() {
            try {
              const position = await getCurrentLocation();
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;

              const response = await fetch(`${apiUrl}&lat=${lat}&lon=${lon}&appid=${apiKey}`);
              const data = await response.json();

              console.log(data);
              document.querySelector('#city').innerHTML = data.name;
              document.querySelector('#temp').innerHTML = Math.round(data.main.temp) + '‚Ñâ';
              document.querySelector('#clouds').innerHTML = data.clouds.all;
            } catch (error) {
              console.error('Error getting location or weather data:', error);
            }
          }

          document.addEventListener('DOMContentLoaded', checkWeather);






         
      </script>
    </body>
  </html>
